<ng-container *ngIf="loading$ | async; then loading; else notLoading"></ng-container>
<ng-template #loading>
    <div style="text-align:center" class="mt-5">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>
</ng-template>
<ng-template #notLoading>
    <div class="mx-4 fs-2">
        <div class="my-3"><b>โปรไฟล์บริษัท</b></div> 
            <ul class="nav nav-underline py-3 mb-2 fs-3 sticky-top" style="top:180px; background:white; --bs-nav-underline-gap:0 1rem; z-index: 5">
                <li class="nav-item">
                    <a class="nav-link active" data-bs-toggle="tab" (click)="profileEditState = false; resetFormGroup()" id="main-profile" data-bs-target="#tabOne" aria-controls="tabOne" type="button" role="tab">ข้อมูลทั่วไป</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" (click)="profileEditState = false; resetFormGroup()" id="private-profile" data-bs-target="#tabTwo" aria-controls="tabTwo" type="button" role="tab" aria-current="page">ติดต่อ</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" (click)="profileEditState = false; resetFormGroup()" id="preferred-jobs" data-bs-target="#tabThree" aria-controls="tabThree" type="button" role="tab" aria-current="page">สวัสดิการ</a>
                </li>
                <hr style="width: 100%" class="m-auto">
            </ul>
            <div class="tab-content fs-3 mx-5">
                <div class="align-items-baseline d-flex justify-content-end ms-3"><button (click)="toggleEdit()" type="button" class="btn btn-primary fs-2" style="padding: 0.5rem 2rem; border-radius: 50px !important">{{!profileEditState?'แก้ไข':'ยกเลิก'}}</button></div>
                <div class="tab-pane active" id="tabOne" role="tabpanel" aria-labelledby="tabOne-tab">
                <ng-container *ngIf="!profileEditState; then displayProfileOne; else editProfileOne"></ng-container>
                <ng-template #displayProfileOne>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-briefcase"></i></div>
                        <div class="keyValueGap">
                            <div><b>ชื่อบริษัท</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2">{{innerProfileInformation.companyName}}</div>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-building"></i></div>
                        <div class="keyValueGap">
                            <div><b>ประเภทธุรกิจ</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2">{{innerProfileInformation.jobType}}</div>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-person-workspace"></i></div>
                        <div class="keyValueGap">
                            <div><b>ขนาดธุรกิจ</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2">{{innerProfileInformation.companySize}}</div>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-cart4"></i></div>
                        <div class="keyValueGap">
                            <div><b>สินค้าและบริการ</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2" [innerHTML]="innerProfileInformation.productsAndServices"></div>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-geo"></i></div>
                        <div class="keyValueGap">
                            <div><b>สถานที่ตั้ง</b></div>
                        </div>
                        <div class="d-flex flex-row">
                            <div>{{innerProfileInformation.Location?.Province}}, {{innerProfileInformation.Location?.District}}, {{innerProfileInformation.Location?.Section}}</div>                    
                        </div>
                    </div>
                    <div>
                        <div class="d-flex flex-row verticalKeyGap">
                            <div class="keyValueGap">
                                <i class="bi bi-geo-alt"></i>
                            </div>
                            <div>
                                <div><b>ปักหมุด</b></div>
                            </div>
                        </div>
                        <div class="d-flex my-3 justify-content-center">
                            <google-map 
                                height="500px"
                                width="900px"
                                [center]="center"
                                [zoom]="zoom">
                                <map-marker
                                    [position]="markerPosition"
                                    >
                                </map-marker>
                            </google-map>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-car-front"></i></div>
                        <div class="keyValueGap">
                            <div><b>วิธีเดินทางไปบริษัท</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2" [innerHTML]="innerProfileInformation.TravelInstructions"></div>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-person"></i></div>
                        <div class="keyValueGap">
                            <div><b>ชื่อผู้ติดต่อ</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2">{{innerProfileInformation.nameOfPerson}}</div>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-telephone-inbound"></i></div>
                        <div class="keyValueGap">
                            <div><b>เบอร์โทรผู้ติดต่อ</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2">{{innerProfileInformation.phoneNumber}}</div>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-envelope-at"></i></div>
                        <div class="keyValueGap">
                            <div><b>Email ฝ่ายบัญชี</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2">{{innerProfileInformation.emailRepresentative}}</div>
                        </div>
                    </div>
                </ng-template>
                <ng-template #editProfileOne>
                    <form [formGroup]="profileEdit" (ngSubmit)="onSave()">
                        <div class="fs-3 my-3">
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="companyName" class="form-label">
                                        <b>ชื่อบริษัท</b>
                                    </label>
                                </div>
                                <div class="col">
                                    <input formControlName="companyName" type="text" class="form-control fs-3">
                                </div>
                            </div>
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="companySize" class="form-label"><b>ขนาดธุรกิจ</b></label>
                                </div>
                                <div>
                                    <select formControlName="companySize" name="companySize" class="form-select fs-3">
                                        <option value="ธุรกิจขนาดเล็ก (ไม่เกิน 50 คน)">ธุรกิจขนาดเล็ก (ไม่เกิน 50 คน)</option>
                                        <option value="ธุรกิจขนาดกลาง (50 – 200 คน)">ธุรกิจขนาดกลาง (50 – 200 คน)</option>
                                        <option value="ธุรกิจขนาดใหญ่ (200 คนขึ้นไป)">ธุรกิจขนาดใหญ่ (200 คนขึ้นไป)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="productsAndServices" class="form-label"><b>สินค้าและบริการ</b></label>
                                </div>
                                <div>
                                    <ckeditor formControlName="productsAndServices" [editor]="productsAndServicesEditor" name="editor"></ckeditor>
                                </div>
                            </div>   
                            <app-location-selector [parentFormGroup]="profileEdit"></app-location-selector>
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="mapLatLng" class="form-label"><b>ปักหมุด</b></label>
                                </div>
                                <div>
                                    <label>Enter address</label>
                                    <input
                                        type="text"
                                        class="form-control my-3"
                                        ngx-google-places-autocomplete 
                                        (onAddressChange)="searchMap($event)"
                                    />
                                  </div>
                                <div class="col d-flex justify-content-center">
                                    <google-map 
                                        height="500px"
                                        width="900px"
                                        [center]="center"
                                        [zoom]="zoom"
                                        (mapClick)="moveMap($event)"
                                        (mapMousemove)="move($event)">
                                        <map-marker
                                        [position]="markerPosition"></map-marker>
                                    </google-map>
                                </div>
                            </div>
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="jobType" class="form-label"><b>วิธีเดินทางไปบริษัท</b></label>
                                </div>
                                <div>
                                    <ckeditor formControlName="TravelInstructions" [editor]="TravelInstructionsEditor" name="editor"></ckeditor>
                                </div>
                            </div>
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="nameOfPerson" class="form-label"><b>ชื่อผู้ติดต่อ</b></label>
                                </div>
                                <div>
                                    <input formControlName="nameOfPerson" type="text" class="form-control fs-3">
                                </div>
                            </div>
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="phoneNumber" class="form-label"><b>เบอร์โทรผู้ติดต่อ</b></label>
                                </div>
                                <div>
                                    <input formControlName="phoneNumber" type="text" class="form-control fs-3">
                                </div>
                            </div>
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="emailRepresentative" class="form-label"><b>Email ฝ่ายบัญชี</b></label>
                                </div>
                                <div>
                                    <input formControlName="emailRepresentative" type="text" class="form-control fs-3">
                                </div>
                            </div>
                        </div>
                    </form>
                </ng-template>
            </div>
            <div class="tab-pane" id="tabTwo" role="tabpanel" aria-labelledby="tabTwo-tab">
                <ng-container *ngIf="!profileEditState; then displayProfileTwo; else editProfileTwo"></ng-container>
                <ng-template #displayProfileTwo>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-telephone"></i></div>
                        <div class="keyValueGap">
                            <div><b>เบอร์โทร</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2">{{innerProfileInformation.contacts?.phone}}</div>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-envelope"></i></div>
                        <div class="keyValueGap">
                            <div><b>Email</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2">{{innerProfileInformation.contacts?.email}}</div>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-line"></i></div>
                        <div class="keyValueGap">
                            <div><b>LINE</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2">{{innerProfileInformation.contacts?.line}}</div>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-globe2"></i></div>
                        <div class="keyValueGap">
                            <div><b>Website</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2">{{innerProfileInformation.contacts?.website}}</div>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-facebook"></i></div>
                        <div class="keyValueGap">
                            <div><b>Facebook</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2">{{innerProfileInformation.contacts?.facebook}}</div>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-twitter"></i></div>
                        <div class="keyValueGap">
                            <div><b>Twitter</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2">{{innerProfileInformation.contacts?.twitter}}</div>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-skype"></i></div>
                        <div class="keyValueGap">
                            <div><b>Skype</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2">{{innerProfileInformation.contacts?.skype}}</div>
                        </div>
                    </div>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-youtube"></i></div>
                        <div class="keyValueGap">
                            <div><b>Youtube</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2">{{innerProfileInformation.contacts?.youtube}}</div>
                        </div>
                    </div>
                   
                </ng-template>
                <ng-template #editProfileTwo>
                    <form [formGroup]="profileEdit" (ngSubmit)="onSave()">
                        <div class="my-3" formGroupName="contacts">
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="phone" class="form-label"><b>เบอร์โทร</b></label>
                                </div>
                                <div>
                                    <input formControlName="phone" type="text" class="form-control fs-3">
                                </div>
                            </div>
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="email" class="form-label"><b>Email</b></label>
                                </div>
                                <div>
                                    <input formControlName="email" type="text" class="form-control fs-3">
                                </div>
                            </div>
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="line" class="form-label"><b>LINE</b></label>
                                </div>
                                <div>
                                    <input formControlName="line" type="text" class="form-control fs-3">
                                </div>
                            </div>
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="website" class="form-label"><b>Website</b></label>
                                </div>
                                <div>
                                    <input formControlName="website" type="text" class="form-control fs-3">
                                </div>
                            </div>
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="facebook" class="form-label"><b>Facebook</b></label>
                                </div>
                                <div>
                                    <input formControlName="facebook" type="text" class="form-control fs-3">
                                </div>
                            </div>
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="twitter" class="form-label"><b>Twitter</b></label>
                                </div>
                                <div>
                                    <input formControlName="twitter" type="text" class="form-control fs-3">
                                </div>
                            </div>
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="skype" class="form-label"><b>Skype</b></label>
                                </div>
                                <div>
                                    <input formControlName="skype" type="text" class="form-control fs-3">
                                </div>
                            </div>
                            <div class="verticalKeyGap">
                                <div class="keyValueGap">
                                    <label for="youtube" class="form-label"><b>Youtube</b></label>
                                </div>
                                <div>
                                    <input formControlName="youtube" type="text" class="form-control fs-3">
                                </div>
                            </div>
                        </div>
                    </form>                    
                </ng-template>
            </div>
            <div class="tab-pane" id="tabThree" role="tabpanel" aria-labelledby="tabThree-tab">
                <ng-container *ngIf="!profileEditState; then displayProfileThree; else editProfileThree"></ng-container>
                <ng-template #displayProfileThree>
                    <div class="d-flex flex-row verticalKeyGap">
                        <div class="keyValueGap"><i class="bi bi-prescription"></i></div>
                        <div class="keyValueGap">
                            <div><b>สวัสดิการ</b></div>
                        </div>
                        <div class="col d-flex">
                            <div class="me-2"[innerHTML]="innerProfileInformation.benefits"></div>
                        </div>
                    </div>
                </ng-template>
                <ng-template #editProfileThree>
                    <form [formGroup]="profileEdit" (ngSubmit)="onSave()">
                        <div class="verticalKeyGap">
                            <div class="keyValueGap">
                                <label for="benefits" class="form-label"><b>สวัสดิการ</b></label>
                            </div>
                            <div>
                                <ckeditor formControlName="benefits" [editor]="benefitsEditor" name="editor"></ckeditor>
                            </div>
                        </div>
                </form>
                </ng-template>
            </div>
            <div class="d-flex justify-content-center" *ngIf="profileEditState">
                <button class="btn btn-success fs-2 my-5" (click)="onSave()">SAVE</button>
            </div>
        </div>
    </div>
</ng-template>
